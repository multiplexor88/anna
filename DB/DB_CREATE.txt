/*show databases;*/
use anna;
/*SHOW TABLES*/;

/*select * from occupation;*/


DROP TABLE IF EXISTS HOBBY;
CREATE TABLE HOBBY( 
	HOBBY_ID BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    HOBBY_TYPE VARCHAR(100) NOT NULL
    ) ENGINE=INNODB DEFAULT CHARSET=UTF8;

DROP TABLE IF EXISTS OCCUPATION;
CREATE TABLE OCCUPATION( 
	OCCUPATION_ID BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    OCCUPATION_TYPE VARCHAR(100) NOT NULL
    ) ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
/*alter table contact drop index EMAIL;*/
select * from contact;
DROP TABLE IF EXISTS CONTACT;
CREATE TABLE CONTACT(
	CONTACT_ID BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    CELL_NUMBER VARCHAR(20) DEFAULT NULL,
    HOME_NUMBER VARCHAR(20) DEFAULT NULL,
	WORK_NUMBER VARCHAR(20) DEFAULT NULL,
    EMAIL VARCHAR(100) DEFAULT NULL
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
DROP TABLE IF EXISTS ADDRESS;
CREATE TABLE ADDRESS(
	ADDRESS_ID BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    COUNTRY VARCHAR(50) DEFAULT NULL,
    STATE VARCHAR(50) DEFAULT NULL,
	CITY VARCHAR(50) DEFAULT NULL,
    STREET VARCHAR(300) DEFAULT NULL
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;

DROP TABLE IF EXISTS PERSON;
CREATE TABLE PERSON(
	PERSON_ID BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    FIRST_NAME VARCHAR(50) DEFAULT NULL,
    LAST_NAME VARCHAR(50) DEFAULT NULL,
	PATRONYMIC VARCHAR(50) DEFAULT NULL,
    GENDER ENUM('MALE', 'FEMALE') DEFAULT NULL,
    CONTACT_ID BIGINT(20) DEFAULT NULL,
    UNIQUE KEY (CONTACT_ID),
    CONSTRAINT FOREIGN KEY (CONTACT_ID) REFERENCES CONTACT(CONTACT_ID) ON DELETE SET NULL ON UPDATE SET NULL
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;

/*CREATE JOIN TABLES FOR PERSON*/
DROP TABLE IF EXISTS PERSON_ADDRESS;
CREATE TABLE PERSON_ADDRESS(
	PERSON_ID BIGINT(20) NOT NULL,
    ADDRESS_ID BIGINT(20) NOT NULL,
    PRIMARY KEY(PERSON_ID, ADDRESS_ID),
    CONSTRAINT FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESS(ADDRESS_ID) ON DELETE CASCADE ON UPDATE CASCADE
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
DROP TABLE IF EXISTS PERSON_HOBBY;
CREATE TABLE PERSON_HOBBY(
	PERSON_ID BIGINT(20) NOT NULL,
    HOBBY_ID BIGINT(20) NOT NULL,
    PRIMARY KEY(PERSON_ID, HOBBY_ID),
    CONSTRAINT FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (HOBBY_ID) REFERENCES HOBBY(HOBBY_ID) ON DELETE CASCADE ON UPDATE CASCADE
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
DROP TABLE IF EXISTS PERSON_OCCUPATION;
CREATE TABLE PERSON_OCCUPATION(
	PERSON_ID BIGINT(20) NOT NULL,
    OCCUPATION_ID BIGINT(20) NOT NULL,
    PRIMARY KEY(PERSON_ID, OCCUPATION_ID),
    CONSTRAINT FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (OCCUPATION_ID) REFERENCES OCCUPATION(OCCUPATION_ID) ON DELETE CASCADE ON UPDATE CASCADE
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
DROP TABLE IF EXISTS EVENT;
CREATE TABLE EVENT(
	EVENT_ID BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    EVENT_DATE VARCHAR(10) NOT NULL,/*CAN USE DATE TYPE, BUT SOMETIMES DO NOT NEED YEAR, SO USE VARCHAR AS: YYYY-MM-DD, IF DO NOT USE YEAR, THEN: XXXX-MM-DD*/   
    EVENT_NAME VARCHAR(100) NOT NULL,
	EVENT_DESCRIPTION TEXT DEFAULT NULL
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
/*CREATE JOIN TABLES FOR EVENT*/
DROP TABLE IF EXISTS EVENT_PERSON;
CREATE TABLE EVENT_PERSON(
	EVENT_ID BIGINT(20) NOT NULL,
    PERSON_ID BIGINT(20) NOT NULL,
    PRIMARY KEY(EVENT_ID, PERSON_ID),
    CONSTRAINT FOREIGN KEY (EVENT_ID) REFERENCES EVENT(EVENT_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID) ON DELETE CASCADE ON UPDATE CASCADE
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
DROP TABLE IF EXISTS EVENT_OCCUPATION;
CREATE TABLE EVENT_OCCUPATION(
	EVENT_ID BIGINT(20) NOT NULL,
    OCCUPATION_ID BIGINT(20) NOT NULL,
    PRIMARY KEY(EVENT_ID, OCCUPATION_ID),
    CONSTRAINT FOREIGN KEY (EVENT_ID) REFERENCES EVENT(EVENT_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (OCCUPATION_ID) REFERENCES OCCUPATION(OCCUPATION_ID) ON DELETE CASCADE ON UPDATE CASCADE
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;
    
DROP TABLE IF EXISTS EVENT_HOBBY;
CREATE TABLE EVENT_HOBBY(
	EVENT_ID BIGINT(20) NOT NULL,
    HOBBY_ID BIGINT(20) NOT NULL,
    PRIMARY KEY(EVENT_ID, HOBBY_ID),
    CONSTRAINT FOREIGN KEY (EVENT_ID) REFERENCES EVENT(EVENT_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FOREIGN KEY (HOBBY_ID) REFERENCES HOBBY(HOBBY_ID) ON DELETE CASCADE ON UPDATE CASCADE
    )ENGINE=INNODB DEFAULT CHARSET=UTF8;